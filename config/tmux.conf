# 0. å¸¸ç”¨å¿«æ·é”®
# {{{
#   tmux ä¼šè¯å¿«æ·æ“ä½œ
#   {{{
#   CTRL+PREFIX_KEY ? æ˜¾ç¤ºå¸®åŠ©æ–‡æ¡£
#   CTRL+PREFIX_KEY : è¿›å…¥tmuxçš„å‘½ä»¤æ¨¡å¼,å¯ä»¥ä½¿ç”¨join-paneç­‰å„ç§å‘½ä»¤
#   CTRL+PREFIX_KEY d detachå½“å‰session, åå°è¿è¡Œ
#   CTRL+PREFIX_KEY D åœ¨å¤šä¸ªsessionä¹‹é—´,é€‰æ‹©è¦detachçš„session, ä½¿ç”¨ctrl+p,nä¸Šä¸‹åˆ‡æ¢, å›è½¦ç¡®å®š
#   CTRL+PREFIX_KEY s å¤šä¸ªsessionä¹‹é—´åˆ‡æ¢, å¯ä»¥ä½¿ç”¨ctrl+p,nä¸Šä¸‹åˆ‡æ¢, æŒ‰å›è½¦ç¡®å®š
#   CTRL+PREFIX_KEY [ è¿›å…¥å¤åˆ¶æ¨¡å¼
#   CTRL+PREFIX_KEY ] ç²˜è´´æ–‡æœ¬
#   CTRL+PREFIX_KEY ~ åˆ—å‡ºæç¤ºä¿¡æ¯ç¼“å­˜
#   }}}

#   window çª—å£ç›¸å…³å¿«æ·æ“ä½œ
#   {{{
#   CTRL+PREFIX_KEY c åˆ›å»ºæ–°çš„window
#   CTRL+PREFIX_KEY n åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªwindow
#   CTRL+PREFIX_KEY p åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªwindow
#   CTRL+PREFIX_KEY & å…³é—­å½“å‰window, éœ€è¦è¾“å…¥y/nç¡®è®¤
#   CTRL+PREFIX_KEY w æ˜¾ç¤ºwindowåˆ—è¡¨,ä¼šæ˜¾ç¤ºæ¯ä¸ªwindowçš„åºå·,ç”¨äºåˆ‡æ¢
#   CTRL+PREFIX_KEY 0~9  åˆ‡æ¢åˆ°æŒ‡å®šwindow
#   CTRL+PREFIX_KEY n åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªwindow
#   CTRL+PREFIX_KEY p åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªwindow
#   CTRL+PREFIX_KEY . é‡å‘½åå½“å‰window
#   CTRL+PREFIX_KEY f å¿«é€Ÿå®šä½å®šä½åˆ°window(éœ€è¦è¾“å…¥windowåç§°çš„å…³é”®å­—)
#   }}}

#   pane çª—æ ¼ç›¸å…³å¿«æ·æ“ä½œ
#   {{{
#   CTRL+PREFIX_KEY " ä¸Šä¸‹åˆ†pane
#   CTRL+PREFIX_KEY % å·¦å³åˆ†pane
#   CTRL+PREFIX_KEY x å…³é—­å½“å‰çš„pane,éœ€è¦è¾“å…¥y/nç¡®è®¤
#   CTRL+PREFIX_KEY z æœ€å¤§åŒ–/æœ€å°åŒ–, åˆ‡æ¢å½“å‰pane
#   CTRL+PREFIX_KEY ! å°†å½“å‰paneåœ¨æ–°çš„windowä¸­æ‰“å¼€
#   CTRL+PREFIX_KEY ; åˆ‡æ¢åˆ°ä¸Šæ¬¡ä½¿ç”¨çš„pane
#   CTRL+PREFIX_KEY q æ˜¾ç¤ºpaneçš„ç¼–å·,åœ¨ç¼–å·æ¶ˆå¤±ä¹‹å‰,æŒ‰å¯¹åº”çš„æ•°å­—å¯ä»¥è¿›è¡Œpaneåˆ‡æ¢
#   CTRL+PREFIX_KEY { é€‰æ‹©ä¸Šä¸€ä¸ªpane
#   CTRL+PREFIX_KEY { é€‰æ‹©ä¸‹ä¸€ä¸ªpane
#   CTRL+PREFIX_KEY o åœ¨å½“å‰windowä¸­é¡ºæ—¶é’ˆé€‰æ‹©panel
#   CTRL+PREFIX_KEY æ–¹å‘é”® åœ¨å½“å‰windowä¸­,æŒ‰æ–¹å‘é€‰æ‹©panel
#   CTRL+PREFIX_KEY ç©ºæ ¼é”® ä½¿ç”¨è‡ªå¸¦çš„paneå¸ƒå±€è¿›è¡Œåˆ‡æ¢
#   CTRL+PREFIX_KEY ALT+æ–¹å‘é”® ä»¥5ä¸ªå•å…ƒæ ¼ä¸ºå•ä½,è°ƒæ•´å½“å‰paneçš„é¢æ¿è¾¹ç¼˜(é¼ æ ‡ä¹Ÿå¯ä»¥æ§åˆ¶)
#   CTRL+PREFIX_KEY CTRL+æ–¹å‘é”® ä»¥1ä¸ªå•å…ƒæ ¼ä¸ºå•ä½,è°ƒæ•´å½“å‰paneçš„é¢æ¿è¾¹ç¼˜(é¼ æ ‡ä¹Ÿå¯ä»¥æ§åˆ¶)
#   }}}
#
#
#   æ»šå±æ“ä½œ
#   {{{
#   å¦‚æœå¯ç”¨äº†viæ¨¡å¼, é¦–å…ˆè¿›å…¥copy-mode: PREFIX + [
#   ä¹‹åå°±å¯ä»¥ä½¿ç”¨vimçš„æ“ä½œè¿›è¡Œæ»šå±æ“
#       H å½“å‰å±å¹•é¡¶ç«¯
#       M å½“å‰å±å¹•ä¸­é—´
#       L å½“å‰å±å¹•åº•éƒ¨
#       CTRL + b å‰ä¸€é¡µ
#       CTRL + f åä¸€é¡µ
#   }}}
#
#   æŠ˜å æ“ä½œ
#   {{{
#   zo æ‰“å¼€å½“å‰æŠ˜å 
#   zO æ‰“å¼€æ‰€åœ¨èŒƒå›´å†…æ‰€æœ‰åµŒå¥—çš„æŠ˜å 
#   zc å…³é—­å½“å‰æŠ˜å 
#   zC å…³é—­æ‰€åœ¨èŒƒå›´å†…æ‰€æœ‰åµŒå¥—çš„æŠ˜å 
#   zR æ‰“å¼€æ‰€æœ‰æŠ˜å 
#   zM å…³é—­æ‰€æœ‰æŠ˜å 
#   zd åˆ é™¤æŠ˜å 
#   zD åˆ é™¤æ‰€æœ‰æŠ˜å 
#   }}}
#
#   å¸¸ç”¨tmuxå‘½ä»¤
#   {{{
#   tmux                        æ–°å»ºåŒ¿åsession
#   tmux new -s session_name    åˆ›å»ºæ–°çš„session
#   tmux new -s session_name -d åå°åˆ›å»ºæ–°çš„session
#   tmux ls                     æ˜¾ç¤ºå½“å‰çš„ä¼šè¯åˆ—è¡¨
#   tmux list-sessions          æ˜¾ç¤ºå½“å‰çš„ä¼šè¯åˆ—è¡¨
#   tmux attach -t session_name|session_number  æ¢å¤ä¼šè¯ä½¿ç”¨
#   tmux detach                 æ–­å¼€å½“å‰ä¼šè¯, åœ¨åå°è¿è¡Œ(éœ€è¦åœ¨tmuxç¯å¢ƒä¸­æ‰§è¡Œ)
#   tmux kill-session -t session_name å…³é—­ä¼šè¯
#   tmux kill-server            å…³é—­tmuxæœåŠ¡å™¨, ç›¸å½“äºå…³é—­æ‰€æœ‰session
#   tmux list-buffers           æ˜¾ç¤ºæ‰€æœ‰buffer
#   tmux show-buffer -b buffer_name   é™åˆ¶æŒ‡å®šçš„bufferå†…å®¹
#   tmux choose-bufffer         è¿›å…¥bufferé€‰æ‹©é¡µé¢,é€‰æ‹©buffer,æ”¯æŒhjkl, å›è½¦è¿›è¡Œé€‰æ‹©
#   tmux set-buffer             è®¾ç½®bufferå†…å®¹
#   tmux load-buffer -b buffer_name file_path   ä»æ–‡ä»¶åŠ è½½æ–‡æœ¬åˆ°buffer
#   tmux save-buffer -a -b buffer_name file_path  ä¿å­˜bufferåˆ°æœ¬åœ°æ–‡ä»¶
#   tmux paste-buffer           ç²˜è´´bufferå†…å®¹åˆ°ä¼šè¯
#   tmux delete-buffer -b buffer_name   åˆ é™¤æŒ‡å®šåç§°çš„buffer
#   }}}
#
#   å…¶ä»–
#   {{{
#   join-pane
#
#     join-pane -s [session_name]:[window].[pane]
#
#     ä¾‹å¦‚: join-pane -s 2:1.1 
#     å³åˆå¹¶ç¬¬äºŒä¸ªä¼šè¯çš„ç¬¬ä¸€ä¸ªçª—å£çš„ç¬¬ä¸€ä¸ªé¢æ¿åˆ°å½“å‰çª—å£
#   }}}

# ä¿®æ”¹prefixé”®ä¸º: CTRL + d
set -g prefix C-d

# å–æ¶ˆé»˜è®¤çš„CTRL + b PREFIX KEY
unbind C-b
#}}}

# 1. ç»ˆç«¯è®¾ç½®
# {{{
# 256è‰²è®¾ç½®: screen-256color
set -g default-terminal "xterm"
# }}}

# 2. é€šç”¨é€‰é¡¹
# {{{
# æŸ¥çœ‹æ‰€æœ‰ç”Ÿæ•ˆé€‰é¡¹çš„æ–¹æ³•: tmux show-options -g

# çª—æ ¼èµ·å§‹åºå·
set -g base-index 1
# æç¤ºä¿¡æ¯çš„æ¶ˆå¤±æ—¶é—´,å•ä½æ¯«ç§’
set -g display-time 5000

# æ§åˆ¶å°æ¿€æ´»åçš„æ—¶é—´, å•ä½æ¯«ç§’
set -g repeat-time 1000

# é»˜è®¤æ“ä½œé”®,æ”¯æŒviå’Œemacs
set -g status-keys vi

# è‡ªå®šä¹‰çŠ¶æ€æ 
# set -g status-right "\"#{=21:pane_title}\" ğŸ³  å°è´ %H:%M %d-%b-%y"
set -g status-right "ğŸ³å°è´%Y-%m-%d %H:%M"
set -g status-interval 60

# è®¾ç½®panelå‰åèƒŒæ™¯è‰²
set -g status-style fg=black,bg=green

# è®¾ç½®æ¶ˆæ¯å‰åèƒŒæ™¯è‰²
set -g message-style fg=black,bg=blue

# å¼€å¯windowäº‹ä»¶æç¤º
set -g visual-activity on
# }}}

# 3. windowè®¾ç½®
# {{{
# æŸ¥çœ‹æ‰€æœ‰windowsç”Ÿæ•ˆé€‰é¡¹çš„æ–¹æ³•: tmux show-window-options -g
# å¯ç”¨viæ¨¡å¼
#     å¤åˆ¶: CTRL + PREFIX_KEY [
#           ä½¿ç”¨ "ç©ºæ ¼+ æ–¹å‘é”®" å¤åˆ¶å†…å®¹
#           å›è½¦ï¼Œ ç¡®è®¤å¤åˆ¶å®Œæˆ
#     ç²˜è´´: CTRL + PREFIX_KEY ]
setw -g mode-keys vi

# å¼€å¯windowäº‹ä»¶æç¤º
setw -g monitor-activity on
# }}}

# 4. é¼ æ ‡ç›¸å…³è®¾ç½®
# {{{
# å¯ç”¨é¼ æ ‡æ¨¡å¼ï¼Œ åŒ…æ‹¬ä½¿ç”¨é¼ æ ‡è¿›è¡Œå¤åˆ¶ç²˜è´´
set -g mouse on
# }}}

# 5. å¤åˆ¶ç²˜è´´
# {{{
# tmuxå¯ä»¥å¤åˆ¶ç²˜è´´åˆ°ç³»ç»Ÿå‰ªåˆ‡æ¿ä¸Š
# éœ€è¦é¦–å…ˆå®‰è£…: brew install reattach-to-user-namespace
# set-option -g default-command "reattach-to-user-namespace -l zsh"

# åŒæ—¶æ”¯æŒlinuxå’Œmac
if-shell 'test "$(uname -s)" = Darwin' 'set-option -g default-command "exec reattach-to-user-namespace -l $SHELL"'

# Macä¸€èˆ¬çš„å¤åˆ¶ç²˜è´´è®¾ç½®
# {{{
# CTRL + PREFIX_KEY CTRL + c, å¤åˆ¶bufferå†…å®¹åˆ°Macçš„ç³»ç»Ÿå‰ªè´´æ¿ä¸Š
bind C-c run "tmux save-buffer - | reattach-to-user-namespace pbcopy"
# CTRL + PREFIX_KEY CTRL + v, ç²˜è´´Macç³»ç»Ÿç²˜è´´æ¿ä¸Šçš„å†…å®¹åˆ°ä¼šè¯ä¸­
bind C-v run "reattach-to-user-namespace pbpaste | tmux load-buffer - \; paste-buffer -d"
# }}}

# viæ¨¡å¼ä¸‹çš„å¤åˆ¶ç²˜è´´è®¾ç½®
#  {{{
# åœ¨viæ¨¡å¼ä¸‹: CTRL + PREFIX_KEY v è¿›å…¥å¼€å§‹é€‰æ‹©æ¨¡å¼
bind-key -T copy-mode-vi v send-keys -X begin-selection

# åœ¨viæ¨¡å¼ä¸‹: CTRL + PREFIX_KEY y å°†é€‰æ‹©çš„å†…å®¹å¤åˆ¶åˆ°ç³»ç»Ÿå‰ªè´´æ¿ä¸Š
# bind-key -T copy-mode-vi y send-keys -X copy-pipe "reattach-to-user-namespace pbcopy"
# bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel pbcopy
bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel 'reattach-to-user-namespace pbcopy'

# Enterå¿«æ·é”®è®¾ç½®
#
# åœ¨viæ¨¡å¼ä¸‹: é€‰æ‹©å®Œæˆå, æŒ‰Enterç»“æŸé€‰æ‹©
unbind -T copy-mode-vi Enter
# bind-key -T copy-mode-vi Enter send-keys -X copy-pipe "reattach-to-user-namespace pbcopy"
# bind-key -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel pbcopy
bind-key -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel 'reattach-to-user-namespace pbcopy'

# åœ¨viæ¨¡å¼ä¸‹: CTRL+PREFIX_KEY ], ç²˜è´´æ–‡æœ¬
bind ] run "reattach-to-user-namespace pbpaste | tmux load-buffer - && tmux paste-buffer"
# }}}
# }}}

# 6. è‡ªå®šä¹‰å¿«æ·é”®
# {{{
# åŒä¸€windowä¸­çš„ä¸åŒpanelä¹‹é—´çš„ç§»åŠ¨
# bind-key  -T prefix       k                select-pane -U
# bind-key  -T prefix       j                select-pane -D
# bind-key  -T prefix       h                select-pane -L
# bind-key  -T prefix       l                select-pane -R

# -r è¡¨ç¤ºå¯ä»¥é‡å¤æŒ‰é”®, 500mså†…é‡å¤æŒ‰é”®éƒ½æœ‰æ•ˆ
bind -r   k   select-pane -U
bind -r   j   select-pane -D
bind -r   h   select-pane -L
bind -r   l   select-pane -R

# è°ƒæ•´paneå¤§å°
bind -r   ^k  resize-pane   -U 10
bind -r   ^j  resize-pane   -D 10
bind -r   ^h  resize-pane   -L 10
bind -r   ^l  resize-pane   -R 10

# ä½¿ç”¨-è¿›è¡Œæ°´å¹³åˆ†å‰²pane
unbind '"'
bind - splitw -v -c '#{pane_current_path}'

# ä½¿ç”¨| è¿›è¡Œå‚ç›´åˆ†å‰²pane
unbind %
bind | splitw -h -c '#{pane_current_path}'

# é€‰æ‹©æœ€åä¸€ä¸ªpane
bind -r e lastp

# ä¸å‰ä¸€ä¸ªpaneäº¤æ¢ä½ç½®
bind -r ^u swapp -U

# ä¸åä¸€ä¸ªpaneäº¤æ¢ä½ç½®
bind -r ^d swapp -D

# é€‰æ‹©æœ€åä¸€ä¸ªwindow, ^è¡¨ç¤ºæŒ‰ä½ctrl
bind -r ^e last

# ç»“æŸå½“å‰ä¼šè¯, å±é™©æ“ä½œ!
# CTRL + PREFIX_KEY e, ç›¸å½“äºè¿›å…¥å‘½ä»¤è¡Œæ¨¡å¼åè¾“å…¥kill-session
# å› ä¸ºä¸å°å¿ƒå°±å…³é—­sessionäº†, å¯èƒ½å¯¼è‡´ä»»åŠ¡ä¸¢å¤±, æ‰€ä»¥ä¸€èˆ¬ä¸è¦å¯ç”¨!!!
# bind-key e kill-session

# å°†å½“å‰é¢æ¿å¸ƒå±€åˆ‡æ¢ä¸ºeven-horizontal
# ç›¸å½“äºè¿›å…¥å‘½ä»¤è¡Œæ¨¡å¼åè¾“å…¥select-layout even-horizontal
# å½“å‰çš„hå¿«æ·é”®å·²ç»è¢«ç§»åŠ¨panelå ç”¨!
# bind-key h select-layout even-horizontal

# å°†å½“å‰é¢æ¿å¸ƒå±€åˆ‡æ¢ä¸ºeven-vertical
# ç›¸å½“äºè¿›å…¥å‘½ä»¤è¡Œæ¨¡å¼åè¾“å…¥select-layout even-vertical
# å½“å‰çš„vå¿«æ·é”®å·²ç»è¢«vimçš„å¤åˆ¶æ¨¡å¼å ç”¨!
# bind-key v select-layout even-vertical

# é‡æ–°åŠ è½½tmuxé…ç½®æ–‡ä»¶
bind r source-file ~/.tmux.conf \; display "reload tmux config file completely!"

# å¿«é€Ÿ4æ ¼å¸ƒå±€
bind m source-file ~/.tmux/layout
# }}}

# 7. æ’ä»¶
# {{{
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'

source-file ~/.tmux/plugins.conf
# }}}


# è¿™å¥ä¸€å®šè¦åœ¨æœ€åæ‰§è¡Œ
run -b '~/.tmux/plugins/tpm/tpm'

